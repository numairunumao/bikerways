function lscf_data_to_filter_subcategories(a,b,c){var d,e,f,g=lscf_return_tax_main_slug(b.ID);if(a=removeObjectKey(a,b.ID),g=lscf_return_tax_main_slug(b.ID),d=parseInt(b.value),a=removeObjectLikeKey(a,g),"undefined"!=typeof c.post_taxonomies[g]&&"undefined"!=typeof c.post_taxonomies[g].tax.subcategs_hierarchy&&"undefined"!=typeof c.post_taxonomies[g].tax.subcategs_hierarchy[d]){e=c.post_taxonomies[g].tax.subcategs_hierarchy[d];for(var h=0;h<e.length;h++)"undefined"!=typeof c.post_taxonomies[g].tax.subcategs_hierarchy[e[h]]&&(f=g+"_-_"+e[h],a[f]={ID:f,type:b.type,value:e[h],filter_as:b.filter_as})}return a}function removeObjectKey(a,b){var c={};for(var d in a)a[d].ID!=b&&(c[d]=a[d]);return c}function removeObjectLikeKey(a,b){var c={};for(var d in a)-1===d.indexOf(b)&&(c[d]=a[d]);return c}function lscf_display_tax_subcategs(a){var b=jQuery;b(".lscf-taxonomies-fields").each(function(){var c=b(this).find(".px_capf-field").attr("data-id");if("undefined"==typeof a[c])return void b(this).find(".subcategs-tax").hide();var d=a[c];b(this).find(".subcategs-tax").each(function(){var a=parseInt(b(this).attr("data-parent")),c=b(this);d.indexOf(a)!=-1?c.fadeIn():(c.hide(),c.find(".styledSelect").text(capfData.options.writing.select),c.find(".px_capf-field").removeClass("active-val"),c.find('input[type="radio"]').removeAttr("checked"))})})}function lscf_reset_default_filter(a,b){var c=b.value,d=lscf_return_tax_main_slug(b.ID);if("undefined"!=typeof a[d]){var e=a[d].tax;for(var f in e.terms)if(0===c)delete a[d];else if("undefined"!=typeof a[d]&&"undefined"!=typeof a[d].tax&&e.terms[f].data.value!=c)if(1==e.terms.length)delete a[d];else{delete a[d].tax.terms[f];var g=lscf_reset_object_index(a[d].terms);a[d].terms=g,a[d].terms.length=g.length,0===g.length&&delete a[d]}}return a}function lscf_return_tax_main_slug(a){var b=a;if(a.match(/(.+?)_-_([0-9]+)$/)){var c=a.match(/(.+?)_-_([0-9]+)$/);b=c[1]}return b}function lscf_reset_object_index(a){var b=[];for(var c in a){"undefined"==typeof b[c]&&(b[c]=[]);for(var d in a[c])b[c].push(a[c][d])}return b}function lscf_custom_dropdowns_update_options_classnames(){var a=jQuery;a(".pxSelectField").each(function(){var b=a(this);a(this).find("select option").each(function(c){1==a(this).attr("ng-data-disabled")?b.find(".lscf-dropdown-option").eq(c).addClass("lscf-option-disabled"):b.find(".lscf-dropdown-option").eq(c).removeClass("lscf-option-disabled")})})}function lscf_sanitize_string(a){return a=a.replace(/([\!\@\#\$\%\^\&\*\(\[\)\]\{\-\}\\\/\:\;\+\=\.\\<\,\>\?\~\`\'\" ]+)/g,"_"),a.toLowerCase()}function lscfAccordionPosts(){var a=jQuery,b=this;this.options={link_type:0},this.init=function(){return a(".lscf-posts-accordion .lscf-title").unbind("click"),"link-only"!==b.options.link_type&&void a(".lscf-posts-accordion .lscf-title").bind("click",function(b){var c=a(this).closest(".lscf-accordion-post");if(c.hasClass("active"))return c.find(".post-caption").animate({height:0},400),c.removeClass("active"),c.addClass("inactive"),!1;a(".lscf-accordion-post").removeClass("active"),a(".lscf-accordion-post").addClass("inactive"),c.addClass("active"),c.removeClass("inactive");var d=c.find(".caption").height()+40;return c.find(".post-caption").animate({height:d},400),a(".lscf-accordion-post.inactive").find(".post-caption").animate({height:0},300),b.preventDefault(),b.stopPropagation(),!1})}}function lscfEventListenerOnCustomTemplateReady(a){var b=new CustomEvent("lscf_on_custom_template_ready",{detail:a});window.dispatchEvent(b)}function lscfEventListenerPostsLoadCallback(a){var b=new CustomEvent("lscf_posts_load_callback",{detail:a});window.dispatchEvent(b)}function lscfAccordionPosts(){var a=jQuery,b=this;this.options={link_type:0},this.init=function(){if(a(".lscf-custom-template-wrapper").hasClass("lscf-posts-accordion"))return a(".lscf-posts-accordion .lscf-title").unbind("click"),"link-only"!==b.options.link_type&&void a(".lscf-posts-accordion .lscf-title").bind("click",function(b){var c=a(this).closest(".lscf-accordion-post");if(c.hasClass("active"))return c.find(".post-caption").animate({height:0},400),c.removeClass("active"),c.addClass("inactive"),!1;a(".lscf-accordion-post").removeClass("active"),a(".lscf-accordion-post").addClass("inactive"),c.addClass("active"),c.removeClass("inactive");var d=c.find(".caption").height()+40;return c.find(".post-caption").animate({height:d},400),a(".lscf-accordion-post.inactive").find(".post-caption").animate({height:0},300),b.preventDefault(),b.stopPropagation(),!1})}}function lscf_initLiveSearch(a){var b,c=jQuery,d=this;this.ready=function(){c(".lscf-live-search-input").length&&c(".lscf-live-search-input").length>0&&(clearInterval(b),a())},b=setInterval(d.ready(),500),setTimeout(function(){clearInterval(b)},3e3)}function lscfSidebarCustomizator(){var a=jQuery,b=this;this.ajaxRequest=new lscfGeneralAjaxRequests,this.templateData={active_terms:[],settings:{run_shortcodes:{key:"run_shortcodes",value:"undefined"!=typeof capfData.options.run_shortcodes?capfData.options.run_shortcodes:0},disable_empty_option_on_filtering:{key:"disable_empty_option_on_filtering",value:"undefined"!=typeof capfData.options.disable_empty_option_on_filtering?capfData.options.disable_empty_option_on_filtering:0},infinite_scrolling:{key:"infinite_scrolling",value:"undefined"!=typeof capfData.options.infinite_scrolling?capfData.options.infinite_scrolling:0},checkboxes_conditional_logic:{key:"checkboxes_conditional_logic",value:"undefined"!=typeof capfData.options.checkboxes_conditional_logic?capfData.options.checkboxes_conditional_logic:"or"},orderable_list:[{id:"post_title",name:"undefined"!=typeof capfData.options.writing.title?capfData.options.writing.title:"Title"},{id:"post_date",name:"undefined"!=typeof capfData.options.writing.date?capfData.options.writing.date:"Date"},{id:"id",name:"ID"},{id:"menu_order",name:"Menu Order"}],order_by:{items:[]},default_order_by:{key:"default_order_by",value:"undefined"!=typeof capfData.options.default_order_by?capfData.options.default_order_by.value:"post_date",order_as:"undefined"!=typeof capfData.options.default_order_by?capfData.options.default_order_by.order_as:"asc"}},post_taxonomies:{items:[],set_tax_term_as_active:function(){return function(a,c){if(b.templateData.active_terms.length>0&&-1!==b.templateData.active_terms.indexOf(c(a)))return'checked="checked"'}}},post_custom_fields:{items:[]},set_settings_option_as_active:function(){return function(a,c){if(1==b.templateData.settings[c(a)].value)return'checked="checked"'}},set_as_active_if_match:function(){return function(a,b){var c=b(a).split("__pxlt__");if(c[0].trim()==c[1].trim())return"checked"}},set_order_fields_as_active:function(){return function(a,c){for(var d=0;d<b.templateData.settings.order_by.items.length;d++)if(b.templateData.settings.order_by.items[d].id==c(a))return'checked="checked"'}}},this.templates={},this.templates.loadTaxonomies=function(b,c){var d=capfData.plugin_url+"assets/js/templates/live-customizer/tax-template.html";a.get(d,function(d){var e=Mustache_2.render(a(d).filter("#template-tax").html(),b);c(e)})},this.templates.loadTemplate=function(b,c,d){a.get(c,function(c){var e=Mustache_2.render(a(c).filter("#template-tax").html(),b);d(e)})},this.serializeExtraOptions=function(){var c=a(".lscf-extrasidebar-template").attr("data-fields-type"),d={type:c,data:{}};switch(c){case"taxonomies-listing":d.data.post_taxonomies={};var e,f,g;b.templateData.active_terms=[],a(".lscf-taxonomies-block").each(function(){a(this).find(".px-checkbox:checked").each(function(){e=a(this).attr("data-taxonomy"),"undefined"==typeof d.data.post_taxonomies[e]&&(d.data.post_taxonomies[e]={},d.data.post_taxonomies[e].ID=e,d.data.post_taxonomies[e].group_type="taxonomies",d.data.post_taxonomies[e].tax={terms:[]}),f=parseInt(a(this).val().split("!#")[0]),g=a(this).val().split("!#")[1],d.data.post_taxonomies[e].tax.terms.push({data:{name:g,value:f}}),b.templateData.active_terms.push(f+"-"+e)})}),d.data.post_taxonomies.active_terms=b.templateData.active_terms;break;case"settings-page":d.data.settings={},b.templateData.settings.order_by.items=[],a('.lscf-fronteditor-settings input[type="checkbox"]').each(function(){var c=a(this).attr("data-key");a(this).hasClass("has-multple-values")?(a(this).prop("checked")&&b.templateData.settings[c].items.push({id:a(this).val(),name:a(this).attr("data-name")}),d.data.settings[c]=b.templateData.settings[c]):(b.templateData.settings[c].value=a(this).prop("checked")?1:0,d.data.settings[c]=b.templateData.settings[c])}),a('.lscf-fronteditor-settings input[type="radio"]').each(function(){var c=a(this).attr("data-key"),e=a(this).attr("data-value");a(this).is(":checked")&&("undefined"!=typeof e?b.templateData.settings[c][e]=a(this).val():b.templateData.settings[c].value=a(this).val(),d.data.settings[c]=b.templateData.settings[c])})}return d},this.init=function(){"undefined"!=typeof capfData.options.order_by&&"undefined"!=typeof capfData.options.order_by.items&&(b.templateData.settings.order_by.items=capfData.options.order_by.items),b.ajaxRequest.getCustomFieldsByPostType(capfData.postType,"all",function(a){if("undefined"!=typeof a.success&&1==a.success){var c=a.data.data.fields;c.forEach(function(a){var c={id:a.field_form_id,name:a.name};b.templateData.post_custom_fields.items.push(c),b.templateData.settings.orderable_list.push(c)})}}),"undefined"!=typeof capfData.settings.theme.posts_display_from&&"undefined"!=typeof capfData.settings.theme.posts_display_from.post_taxonomies&&"undefined"!=typeof capfData.settings.theme.posts_display_from.post_taxonomies.active_terms&&(b.templateData.active_terms=capfData.settings.theme.posts_display_from.post_taxonomies.active_terms),b.get_post_taxonomies_and_terms(function(a){b.templateData.post_taxonomies.items=a}),a("#lscf-expand-sidebar-extra-options, .lscf-open-extra-sidebar").click(function(){a(".lscf-close-customizer").addClass("lscf-hide"),a(".lscf-sidebar-extra-container").addClass("active");var c=a(this).closest(".lscf-sidebar-option").attr("data-type");b.loadExtraSidebarContent(c)}),a(".lscf-open-customizer").click(function(){a(this).addClass("deactivate-animations"),a(".lscf-sidebar-live-customizer").addClass("active"),a("#lscf-posts-wrapper").addClass("translate")}),a(".lscf-close-customizer").click(function(){a(".lscf-sidebar-live-customizer").removeClass("active"),a("#lscf-posts-wrapper").removeClass("translate")}),b.initCustomDropdown();var c=a(".lscf-theme-list").find('input[type="radio"]:checked').val();b.initThemeOptions(c)},this.loadExtraSidebarContent=function(c){switch(c){case"show-from-categories":b.templates.loadTaxonomies(b.templateData.post_taxonomies,function(b){a(".lscf-sidebar-extra-container-wrapper").html(b),a(".lscf-sidebar-extra-container-wrapper").customScrollbar()});break;case"filter-settings":var d=capfData.plugin_url+"assets/js/templates/live-customizer/settings-template.html";b.templates.loadTemplate(b.templateData,d,function(b){a(".lscf-sidebar-extra-container-wrapper").html(b),a(".lscf-sidebar-extra-container-wrapper").customScrollbar()})}},this.saveExtraOptions=function(c){a("#save-and-close-extra-options").click(function(){a(".lscf-close-customizer").removeClass("lscf-hide"),a(".lscf-sidebar-extra-container").removeClass("active");var d=b.serializeExtraOptions();c(d)})},this.initColorpicker=function(b){var c=!1;a(".lscf-colorpicker").colorPicker({renderCallback:function(a,d){if(!0===d&&(c=!1),!1===d&&!1===c){c=!0;var e=a[0].style.backgroundColor.replace(/rgb\(|\)/g,""),f=a[0].value;b({hex:f,rgb:e})}}})},this.generateDynamicCssColor=function(b){a.ajax({type:"POST",url:capfData.ajax_url,data:{action:"px-plugin-ajax",section:"generate-theme-color-style",color:b},success:function(a){var b=document.getElementById("px_base-inline-css");b.innerHTML=a},dataType:"html"})},this.get_post_taxonomies_and_terms=function(b){a.ajax({type:"POST",url:capfData.ajax_url,data:{action:"lscf-administrator-ajax",section:"get_taxonomies_and_terms",post_type:capfData.postType},success:function(a){b(a)},dataType:"json"})},this.saveSettings=function(b){a.ajax({type:"POST",url:capfData.ajax_url,data:{action:"lscf-administrator-ajax",section:"save-filter-settings",filter_id:capfData.ID,settings:b},success:function(a){},dataType:"html"})},this.onFormAction=function(c){var d,e,f,g,h={};a(".lscf-sidebar-option").each(function(){switch(d=a(this).attr("data-field-type")){case"dropdown":a(this).find(".options li ").each(function(){a(this).click(function(){f=a(this).attr("rel"),e=a(this).closest(".lscf-sidebar-option").attr("data-type"),h={fieldType:d,dataType:e,fieldValue:f},c(h)})});break;case"checkbox":a(this).find("#lscf-fields-ordering").click(function(){var b=a(this).closest(".lscf-check-btn");f="undefined"!=typeof b.find('input[type="checkbox"]:checked').val()?parseInt(b.find('input[type="checkbox"]:checked').val()):0,e=a(this).closest(".lscf-sidebar-option").attr("data-type"),h={fieldType:d,dataType:e,fieldValue:!f},c(h)});break;case"radiobutton":a(this).on("click",".lscf-live-customizer-radiobutton-label",function(){f=a(this).attr("data-value"),b.initThemeOptions(f),"custom-theme"==f&&(g=a(this).attr("data-index")),e="theme-style",h={fieldType:d,dataType:e,fieldValue:f,custom_theme_active_index:g},c(h)});break;case"number":a(this).find('input[type="number"]').blur(function(){f="NaN"!==parseInt(a(this).val())?parseInt(a(this).val()):15,e=a(this).closest(".lscf-sidebar-option").attr("data-type"),h={fieldType:d,dataType:e,fieldValue:f},c(h)})}})},this.initThemeOptions=function(b){switch(a(".lscf-optional-option").hide(),b){case"default":a(".lscf-optional-grid").fadeIn(),a(".lscf-optional-viewchanger").fadeIn();break;case"accordion":a(".lscf-optional-linktype").fadeIn();break;case"portrait":a(".lscf-optional-grid").fadeIn();break;case"woocommerce-grid":case"basic-grid":a(".lscf-optional-grid").fadeIn()}},this.initCustomDropdown=function(){a(".lscf-custom-select-dropwdown").each(function(){var b=a(this).attr("data-class"),c=a(this),d=a(this).children("option").length;c.addClass("s-hidden"),c.wrap('<div class="select '+b+'"></div>'),c.after('<div class="styledSelect"></div>');var e,f,g=c.next("div.styledSelect");c.find("option").each(function(b){a(this).is(":selected")&&(f=b)}),e=c.find("option:selected")?c.find("option:selected").text():c.children("option").eq(0).text(),g.text(e);for(var h=a("<ul />",{class:"options"}).insertAfter(g),i=0;i<d;i++){var j=f==i?"pxselect-hidden-list":"";a("<li />",{text:c.children("option").eq(i).text(),rel:c.children("option").eq(i).val(),class:j}).appendTo(h)}var k=h.children("li");g.click(function(b){b.stopPropagation(),a("div.styledSelect.active").each(function(){a(this).removeClass("active").next("ul.options").hide()}),a(this).toggleClass("active").next("ul.options").toggle()}),k.click(function(b){k.removeClass("pxselect-hidden-list"),a(this).addClass("pxselect-hidden-list"),b.stopPropagation(),g.text(a(this).text()).removeClass("active"),c.val(a(this).attr("rel")),h.hide()}),a(document).click(function(){g.removeClass("active"),h.hide()})})}}function lscfGeneralAjaxRequests(){var a=jQuery,b="px-plugin-ajax";this.getCustomFieldsByPostType=function(c,d,e){a.ajax({type:"POST",url:capfData.ajax_url,data:{action:b,section:"getPostType_customFields",fieldType:d,post_type:c},success:function(a){e(a)},dataType:"json"})}}function lscfSortingCustomDropddown(){var a=jQuery;a(".lscf-sorting-custom-dropdown").each(function(){var b=a(this).attr("data-class"),c=a(this),d=a(this).children("option").length;c.addClass("s-hidden"),c.wrap('<div class="select '+b+'"></div>'),c.after('<div class="styledSelect"></div>');var e=c.next("div.styledSelect");e.text(c.children("option").eq(0).text());for(var f=a("<div />",{class:"options"}).insertAfter(e),g=0;g<d;g++){var h=0===g?"lscf-dropdown-option pxselect-hidden-list":"lscf-dropdown-option";a("<div />",{text:c.children("option").eq(g).text(),rel:c.children("option").eq(g).val(),class:h}).appendTo(f)}var i=f.children(".lscf-dropdown-option");e.click(function(b){b.stopPropagation(),a("div.styledSelect.active").each(function(){a(this).removeClass("active").next("div.options").hide()}),a(this).toggleClass("active").next("div.options").toggle(),a(this).toggleClass("active").next("div.options").customScrollbar()}),i.click(function(b){i.removeClass("pxselect-hidden-list"),a(this).addClass("pxselect-hidden-list"),b.stopPropagation(),e.text(a(this).text()).removeClass("active"),c.val(a(this).attr("rel")),f.hide()}),a(document).click(function(){e.removeClass("active"),f.hide()})})}var angAppName="",appElems=document.querySelectorAll("[ng-app]");appElems.length>=1?(angAppName=appElems[0].getAttribute("ng-app"),"px-capf"==angAppName&&angular.module("px-capf",["ngSanitize","ngAnimate"]).config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["self",capfData.plugin_url+"**"])}])):(angAppName="px-capf",angular.module("px-capf",["ngSanitize","ngAnimate"]).config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["self",capfData.plugin_url+"**"])}])),angular.module(angAppName).controller("pxfilterController",["$scope","$sce","customFilterService",function(a,b,c){function d(){var b=document.documentElement.scrollTop||document.body.scrollTop,c=document.body,d=document.documentElement,e=Math.max(c.scrollHeight,c.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight),f=window.innerHeight;b+f+250>=e&&!1===a.loadMoreBtn.loading&&(a.load_more(),e=Math.max(c.scrollHeight,c.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight))}var e,f,g,h,i,j,k=capfData.post_per_page,l=1,m=capfData.ID,o="",p=capfData.postType,q=new px_customRange,r=new customSelectBox,s=new lscfOrderFilterFields,t=null,u=new pxFilterFieldsAction;a.loading=!1,a.noResults=!1,a.morePostsAvailable=!1,a.variations={},a.featuredLabel=!1,a.postType=p,a.existsPosts=!1,a.filterPostsTemplate={},a.directiveInfo={},a.liveSearchTemplate={class:""},a.actionSettings={style:{postMaxHeight:null},customFields:[],pxCurrentPage:l,postsPerPage:k,lsLoadPosts:!0,activeTerms:[],postsCount:"",pagesCount:"",activeQuery:[],filterPostsTemplate:[],previousSidebarPosition:"",disableInactiveTerms:!1,initSidebar:!1,initPostTheme:!1,initFieldsDraggable:!1,isAdministrator:"undefined"!=typeof capfData.settings.is_administrator?parseInt(capfData.settings.is_administrator):0},a.lscfSidebar={},a.loadMoreBtn={morePostsAvailable:!1,noResults:!1,loading:!1,postsLoading:!0,sidebarLoading:!0,ready:!0,type:"default"},a.pluginSettings={className:{sidebar:"",posts_theme:""},existsPosts:!0,pluginPath:capfData.plugin_url,filterSettings:capfData.settings,generalSettings:capfData.options,editShortcodeLink:capfData.site_url+"/wp-admin/admin.php?page=pxLF_plugin&plugin-tab=filter-generator&edit_filter="+capfData.ID},a.trust_as_html=function(a){return b.trustAsHtml(a)},a.standartize_shortcodes_container_height=function(){var b=jQuery,c=!1,d=a.actionSettings.style.postMaxHeight;return b(".lscf-standartize-shorcodes-container-height").length>0?(c=!0,b(".lscf-standartize-shorcodes-container-height").each(function(){var a=b(this).height();d<a&&(d=a)}),b(".lscf-standartize-shorcodes-container-height").attr({style:"height:"+d+"px"}),void(a.actionSettings.style.postMaxHeight=d)):void setTimeout(function(){a.standartize_shortcodes_container_height()},300)},1===a.pluginSettings.generalSettings.infinite_scrolling?window.addEventListener("scroll",d):window.removeEventListener("scroll",d),a.makeWrapperClassName=function(){var b={sidebar:"",posts_theme:""};return"top"==a.pluginSettings.filterSettings.theme.sidebar.position||"0"==a.pluginSettings.filterSettings.theme.sidebar.position?(b.sidebar="col-sm-12 col-md-12 col-lg-12 lscf-horizontal-sidebar ",b.posts_theme="col-sm-12 col-md-12 col-lg-12 lscf-wide-posts "):(b.sidebar=capfData.settings.theme.columns>3?"col-sm-2 col-md-2 col-lg-2 ":"col-sm-3 col-md-3 col-lg-3 ",b.posts_theme=capfData.settings.theme.columns>3?"col-sm-10 col-md-10 col-lg-10 ":"col-sm-9 col-md-9 col-lg-9 "),b},a.$watch("actionSettings.postsPerPage",function(b,d){b!=d&&c.getPosts(p,a.actionSettings.postsPerPage,l,a.actionSettings.activeQuery).success(function(b){a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage=l+1,a.actionSettings.pxCurrentPage>b.pages&&(a.loadMoreBtn.morePostsAvailable=!1),a.loadMoreBtn.loading=!1,a.actionSettings.filterPostsTemplate=b.posts,a.filterPostsTemplate.posts=a.actionSettings.filterPostsTemplate,a.directiveInfo.afterPostsLoadCallback()})}),a.$watch("actionSettings.initFieldsDraggable",function(a,b){!0===a&&(s.fieldsData={fields:e.default_data.fields,filterID:m},setTimeout(function(){s.draggable.initFilterFields(),s.draggable.initOptionOrder()},300)),!1===a&&(s.draggable.unbindOrder(),s.draggable.unbindOptionOrder())}),a.$watch("actionSettings.initPostTheme",function(b,c){!0===b&&(a.actionSettings.initPostTheme=!1,a.directiveInfo.ready())}),h=a.makeWrapperClassName(a.pluginSettings.filterSettings.theme.sidebar.position),a.pluginSettings.className.sidebar=h.sidebar,a.pluginSettings.className.posts_theme=h.posts_theme,a.load_more=function(){if(a.loadMoreBtn.loading=!0,!1!==a.loadMoreBtn.morePostsAvailable){if(jQuery(".lscf-standartize-shorcodes-container-height").removeClass("lscf-standartize-shorcodes-container-height"),"range"==a.loadMoreBtn.type){for(var b=a.actionSettings.rangeCurrentPage,d=a.actionSettings.postsPerPage,e=parseInt(b)*parseInt(d),f=[],g=e;g<a.matched_posts.length&&("undefined"!=typeof a.matched_posts[g]&&g<e+parseInt(d));g++)f.push(a.matched_posts[g]);return a.matched_posts.length<=e+parseInt(d)?a.loadMoreBtn.morePostsAvailable=!1:a.loadMoreBtn.morePostsAvailable=!0,a.actionSettings.filterPostsTemplate=a.actionSettings.filterPostsTemplate.concat(f),a.filterPostsTemplate.posts=a.actionSettings.filterPostsTemplate,a.directiveInfo.afterPostsLoadCallback(),a.actionSettings.rangeCurrentPage+=1,void(a.loadMoreBtn.loading=!1)}var h=a.actionSettings.customFields;null!==t&&0===h.length&&(h=t),c.getPosts(p,a.actionSettings.postsPerPage,a.actionSettings.pxCurrentPage,h).success(function(b){a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage+=1,a.actionSettings.pxCurrentPage>b.pages&&(a.loadMoreBtn.morePostsAvailable=!1),a.loadMoreBtn.loading=!1,a.actionSettings.filterPostsTemplate=a.actionSettings.filterPostsTemplate.concat(b.posts),a.filterPostsTemplate.posts=a.actionSettings.filterPostsTemplate,a.directiveInfo.afterPostsLoadCallback()})}},c.getSidebar().success(function(b){a.lscfSidebar.html=b}),c.getFilterFields(m).success(function(b){if(a.loadMoreBtn.sidebarLoading=!1,o=b.filter_type,"undefined"!=typeof b.default_data.custom_templates&&(a.pluginSettings.custom_templates=b.default_data.custom_templates),"undefined"!=typeof b.default_data.settings.theme.posts_display_from&&"undefined"!==b.default_data.settings.theme.posts_display_from.post_taxonomies.active_terms&&b.default_data.settings.theme.posts_display_from.post_taxonomies.active_terms.length>0){var d={default_filter:{}};"undefined"!=typeof b.fields&&(d.default_filter.fields=b.fields),d.default_filter.post_taxonomies=b.default_data.settings.theme.posts_display_from.post_taxonomies,t=d,c.getPosts(p,a.actionSettings.postsPerPage,l,d).success(function(b){a.actionSettings.activeTerms=b.active_terms,a.actionSettings.postsHasLoaded=!0,a.loadMoreBtn.postsLoading=!1,a.filterPostsTemplate.filter_type=b.filter_type,b.postsCount<1&&(a.pluginSettings.existsPosts=!1),b.posts.length>0?a.loadMoreBtn.noResults=!1:a.loadMoreBtn.noResults=!0,1===b.featuredLabel&&(a.featuredLabel=!0),a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage=l+1,a.allPostsCount=b.postsCount,a.actionSettings.pxCurrentPage<=b.pages&&(a.loadMoreBtn.morePostsAvailable=!0),g=a.loadMoreBtn.morePostsAvailable,a.actionSettings.filterPostsTemplate=b.posts,f=b.posts,a.filterPostsTemplate.posts=a.actionSettings.filterPostsTemplate,a.directiveInfo.ready(),a.directiveInfo.afterPostsLoadCallback(),a.loadMoreBtn.postsLoading=!1})}else c.getPosts(p,a.actionSettings.postsPerPage,l,null).success(function(b){a.actionSettings.activeTerms=b.active_terms,a.filterPostsTemplate.filter_type=b.filter_type,a.loadMoreBtn.postsLoading=!1,b.postsCount<1&&(a.pluginSettings.existsPosts=!1),b.posts.length>0?a.loadMoreBtn.noResults=!1:a.loadMoreBtn.noResults=!0,1===b.featuredLabel&&(a.featuredLabel=!0),a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage=l+1,a.allPostsCount=b.postsCount,a.actionSettings.pxCurrentPage<=b.pages&&(a.loadMoreBtn.morePostsAvailable=!0),g=a.loadMoreBtn.morePostsAvailable,a.actionSettings.filterPostsTemplate=b.posts,f=b.posts,a.filterPostsTemplate.posts=a.actionSettings.filterPostsTemplate,a.directiveInfo.ready(),a.directiveInfo.afterPostsLoadCallback(),a.loadMoreBtn.postsLoading=!1});var h=[];if(null!==t)for(var k=0;k<t.default_filter.post_taxonomies.active_terms.length;k++)for(var m=t.default_filter.post_taxonomies.active_terms[k].match(/^([0-9]+)-(.*)/),s=parseInt(m[1]),v=m[2],w=0;w<b.fields.length;w++)if("taxonomies"==b.fields[w].group_type&&"undefined"!=typeof b.fields[w].tax&&b.fields[w].tax.slug==v){b.fields[w].tax.activeTermsLength=t.default_filter.post_taxonomies.active_terms.length;for(var x=0;x<b.fields[w].tax.terms.length;x++){var y=b.fields[w].tax.terms[x];s==y.data.value&&(b.fields[w].tax.terms[x].checked=!0)}}e=b,a.filterFieldsTemplate=e,a.actionSettings.initSidebar=!0,a.$watch("actionSettings.initSidebar",function(d,k){if(i="left"==a.pluginSettings.filterSettings.theme.sidebar.position||"top"==a.pluginSettings.filterSettings.theme.sidebar.position?1:2,"left"==a.actionSettings.previousSidebarPosition||"top"==a.actionSettings.previousSidebarPosition?j=1:""!==a.actionSettings.previousSidebarPosition&&(j=2),!0===d){if(a.actionSettings.initSidebar=!1,a.actionSettings.previousSidebarPosition=a.pluginSettings.filterSettings.theme.sidebar.position,i===j)return;r.construct(),u.construct(function(d){l=1,h=a.actionSettings.customFields;var i="add";if(a.loadMoreBtn.postsLoading=!0,d.constructor!==Array){var j=[];j[0]=d,d=j}$j(".lscf-live-search-input").val(""),d.forEach(function(b){switch(i="add",b.type){case"date-interval":if(""===b.fields.from||""===b.fields.to)return;break;case"checkbox_post_terms":0===b.value.length&&(h=removeObjectKey(h,b.ID),"cf_variation"==b.group_type&&("undefined"==typeof a.variations[b.ID]&&(a.variations[b.variation_id]={}),a.variations[b.variation_id].active="default"),i="remove");break;case"px_icon_check_box":case"checkbox":if(0===b.value.length){if(h=removeObjectKey(h,b.ID),"checkbox_post_terms"==b.filter_as)for(var c in h)if("default_filter"==h[c].type){h[c].default_filter.post_taxonomies=lscf_reset_default_filter(h[c].default_filter.post_taxonomies,b);break}"cf_variation"==b.group_type&&("undefined"==typeof a.variations[b.ID]&&(a.variations[b.variation_id]={}),a.variations[b.variation_id].active="default"),i="remove"}break;case"select":if(b.value.constructor===Array?sVal=b.value[0]:sVal=b.value,"select"==sVal.toLowerCase()||"0"==sVal){if(h=removeObjectKey(h,b.ID),h=removeObjectLikeKey(h,b.ID),"cf_variation"==b.group_type&&("undefined"==typeof a.variations[b.ID]&&(a.variations[b.variation_id]={}),a.variations[b.variation_id].active="default"),i="remove","checkbox_post_terms"==b.filter_as)for(var d in h)if("default_filter"==h[d].type){h[d].default_filter.post_taxonomies=lscf_reset_default_filter(h[d].default_filter.post_taxonomies,b);break}}else"checkbox_post_terms"==b.filter_as&&(h=lscf_data_to_filter_subcategories(h,b,e));break;case"radio":if(b.value.constructor===Array?sVal=b.value[0]:sVal=b.value,"0"==sVal){if(h=removeObjectKey(h,b.ID),i="remove","cf_variation"==b.group_type&&("undefined"==typeof a.variations[b.ID]&&(a.variations[b.variation_id]={}),a.variations[b.variation_id].active="default"),"checkbox_post_terms"==b.filter_as)for(var f in h)if("default_filter"==h[f].type){h[f].default_filter.post_taxonomies=lscf_reset_default_filter(h[f].default_filter.post_taxonomies,b);break}}else"checkbox_post_terms"==b.filter_as&&(h=lscf_data_to_filter_subcategories(h,b,e));break;case"date":""===b.value&&(h=removeObjectKey(h,b.ID),i="remove")}if("add"==i){if("cf_variation"==b.group_type){"undefined"==typeof a.variations[b.ID]&&(a.variations[b.variation_id]={});var g=b.value.constructor==Array?b.value[0]:b.value;a.variations[b.variation_id].active=lscf_sanitize_string(g)}var j=!1;for(var k in h)if(h[k].ID==b.ID){h[k]=b,j=!0;break}if(!1===j&&(h[b.ID]=b),"checkbox_post_terms"==b.filter_as)for(var l in h)if("default_filter"==h[l].type){h[l].default_filter.post_taxonomies=lscf_reset_default_filter(h[l].default_filter.post_taxonomies,b);break}a.loadMoreBtn.type="default"}});var k,m=[],o=[],q=[];for(var r in h){var s=h[r];if("undefined"!=typeof s.ID&&(m.push(s),"undefined"!=typeof s.filter_as&&"checkbox_post_terms"==s.filter_as)){var v,w=lscf_return_tax_main_slug(s.ID);if("undefined"==typeof o[w]&&(o[w]=[],q.push(s.ID)),Array===s.value.constructor)for(var x=0;x<s.value.length;x++){if("undefined"!=typeof b.post_taxonomies[w]&&"undefined"!=typeof b.post_taxonomies[w].tax.subcategs_hierarchy&&"undefined"!=typeof b.post_taxonomies[w].tax.subcategs_hierarchy[s.value[x]])for(k=b.post_taxonomies[w].tax.subcategs_hierarchy[s.value[x]],n=0;n<k.length;n++)v=parseInt(k[n]),o[w][v]=v;v=parseInt(s.value[x]),o[w][v]=v}else if(v=parseInt(s.value),o[w][v]=v,"undefined"!=typeof b.post_taxonomies[w]&&"undefined"!=typeof b.post_taxonomies[w].tax.subcategs_hierarchy&&"undefined"!=typeof b.post_taxonomies[w].tax.subcategs_hierarchy[s.value])for(k=b.post_taxonomies[w].tax.subcategs_hierarchy[s.value],n=0;n<k.length;n++)v=parseInt(k[n]),o[w][v]=v}}if(o=lscf_reset_object_index(o),lscf_display_tax_subcategs(o),null!==t&&"undefined"!=typeof t.default_filter.post_taxonomies&&"undefined"!=typeof t.default_filter.post_taxonomies.active_terms&&t.default_filter.post_taxonomies.active_terms.length>0){var y={};for(ki=0;ki<t.default_filter.post_taxonomies.active_terms.length;ki++){var z=t.default_filter.post_taxonomies.active_terms[ki];if(z.match(/([0-9]+)-(.+?)$/)){var A=z.match(/([0-9]+)-(.+?)$/),B=A[1],C=A[2];-1==q.indexOf(C)&&("undefined"==typeof y[C]?y[C]={ID:C,filter_as:"checkbox_post_terms",group_type:"taxonomies",type:"checkbox_post_terms",value:[B],variation_id:null}:y[C].value.push(B))}}for(var D in y)m.push(y[D])}a.actionSettings.activeQuery=m,a.actionSettings.customFields=m,c.getPosts(p,a.actionSettings.postsPerPage,l,m).success(function(b){if(a.actionSettings.lsLoadPosts=!0,b.active_terms.length>0){a.actionSettings.disableInactiveTerms=!0;for(var c=a.filterFieldsTemplate.fields,d=0;d<c.length;d++)if("taxonomies"==c[d].group_type)for(var e=0;e<c[d].tax.terms.length;e++){var f=c[d].tax.terms[e].data.value;"undefined"==typeof b.active_terms[f]?c[d].tax.terms[e].data.not_active=!0:c[d].tax.terms[e].data.not_active=!1}else if("custom_field"==c[d].group_type&&"undefined"!=typeof b.active_terms.custom_fields&&"undefined"!=typeof c[d].options)for(var g=0;g<c[d].options.length;g++){var h=c[d].ID+lscf_sanitize_string(c[d].options[g].opt);"undefined"==typeof b.active_terms.custom_fields[h]?c[d].options[g].not_active=!0:c[d].options[g].not_active=!1}a.filterFieldsTemplate.fields=c,setTimeout(function(){lscf_custom_dropdowns_update_options_classnames()},500)}else a.actionSettings.disableInactiveTerms=!1,setTimeout(function(){lscf_custom_dropdowns_update_options_classnames()},500);b.posts.length>0?a.loadMoreBtn.noResults=!1:a.loadMoreBtn.noResults=!0,a.actionSettings.activeTerms=b.active_terms,a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage=l+1,a.actionSettings.customFields=m,a.actionSettings.pxCurrentPage<=b.pages?a.loadMoreBtn.morePostsAvailable=!0:a.loadMoreBtn.morePostsAvailable=!1,a.actionSettings.filterPostsTemplate=b.posts,a.filterPostsTemplate.posts=b.posts,a.loadMoreBtn.postsLoading=!1,a.directiveInfo.afterPostsLoadCallback();
}),a.reset_filter=function(){u.reset_fields(),a.filterPostsTemplate.posts=f,a.actionSettings.filterPostsTemplate=f,a.loadMoreBtn.morePostsAvailable=g,h=null,h=[],a.actionSettings.customFields=null,a.actionSettings.customFields=[],a.actionSettings.pxCurrentPage=2,a.loadMoreBtn.noResults=!1,a.directiveInfo.afterPostsLoadCallback()}})}}),q.construct(function(b){l=1,h[b.ID]=b,"px-woocommerce-price"!==b.ID&&"px-woocommerce-inventory"!==b.ID&&(a.loadMoreBtn.type="range");var d=[];for(var e in h)"undefined"!=typeof h[e].ID&&d.push(h[e]);a.loadMoreBtn.postsLoading=!0,a.actionSettings.rangeCurrentPage=2,c.getPosts(p,a.actionSettings.postsPerPage,l,d).success(function(b){b.posts.length>0?a.loadMoreBtn.noResults=!1:a.loadMoreBtn.noResults=!0,a.actionSettings.activeTerms=b.active_terms,a.matched_posts=b.matched_posts,a.actionSettings.postsCount=b.postsCount,a.actionSettings.pagesCount=b.pages,a.actionSettings.pxCurrentPage=l+1,a.actionSettings.customFields=d,a.actionSettings.pxCurrentPage<=b.pages?a.loadMoreBtn.morePostsAvailable=!0:a.loadMoreBtn.morePostsAvailable=!1,a.actionSettings.filterPostsTemplate=b.posts,a.filterPostsTemplate.posts=b.posts,a.directiveInfo.afterPostsLoadCallback(),a.loadMoreBtn.postsLoading=!1})})})}]),angular.module(angAppName).factory("capfAPI",["$http",function(a){var b=pxData.ajaxURL+"?action=px-ang-http",c=capfData.rest_api_uri+"lscf_rest/";return{uri:b,restApi:{uri:c,getSidebar:c+"get_sidebar",filterPosts:c+"filter_posts"}}}]),angular.module(angAppName).factory("customFilterService",["$http","capfAPI",function(a,b){function c(c){return a({method:"post",url:b.restApi.getSidebar,data:{filter_id:c}})}function d(){return a({method:"post",url:b.uri,data:{section:"getSidebar"}})}function e(c,d,e,f){return a({method:"post",url:b.restApi.filterPosts,data:{post_type:c,featured_label:capfData.featuredLabel,limit:d,page:e,q:f,filter_id:capfData.ID}})}function f(c,d,e,f){return a({method:"post",url:b.restApi.filterPosts,data:{post_type:c,featured_label:capfData.featuredLabel,limit:d,page:e,q:f,filter_id:capfData.ID}})}return{getAllPosts:f,getFilterFields:c,getPosts:e,getSidebar:d}}]),angular.module(angAppName).directive("viewmodeAccordion",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-accordion.html",link:function(a,b,c){var d=new lscfAccordionPosts;a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){d.options.link_type="undefined"!=typeof a.pluginSettings.filterSettings.theme.link_type?a.pluginSettings.filterSettings.theme.link_type:0,setTimeout(function(){d.init()},500)},a.directiveInfo.afterPostsLoadCallback=function(){setTimeout(function(){d.init()},500)}}}}]),angular.module(angAppName).directive("ajaxSearch",["customFilterService",function(a){return{restrict:"AE",require:"?ngModel",scope:!0,bindToController:!0,controllerAs:"vm",link:function(b,c,d,e){var f=d.searchType;b.ajaxSearch=function(){var c,d,e={},g=!1;switch(f){case"general-search":c=b.pxsearch,g=!1;for(var h=0;i<b.actionSettings.customFields.length;i++)d=b.actionSettings.customFields[h],"ajax-main-search"==d.ID&&(b.actionSettings.customFields[h].value=c,g=!0);!1===g&&(e={ID:"ajax-main-search",filter_as:null,type:"main-search",value:c},b.actionSettings.customFields.push(e));break;case"woo-product-sku":c=b.pxsearch_woo_sku,g=!1;for(var i=0;i<b.actionSettings.customFields.length;i++)d=b.actionSettings.customFields[i],"ajax-product-sku-search"==d.ID&&(b.actionSettings.customFields[i].value=c,g=!0);!1===g&&(e={ID:"ajax-product-sku-search",filter_as:null,type:"main-search",value:c},b.actionSettings.customFields.push(e))}b.loadMoreBtn.postsLoading=!0,a.getPosts(b.postType,b.actionSettings.postsPerPage,1,b.actionSettings.customFields).success(function(a){b.actionSettings.postsCount=a.postsCount,b.actionSettings.pagesCount=a.pages,b.actionSettings.pxCurrentPage=2,b.actionSettings.pxCurrentPage<=a.pages?b.loadMoreBtn.morePostsAvailable=!0:b.loadMoreBtn.morePostsAvailable=!1,b.actionSettings.filterPostsTemplate=a.posts,b.filterPostsTemplate.posts=a.posts,b.loadMoreBtn.postsLoading=!1,b.directiveInfo.afterPostsLoadCallback()})},c.bind("keydown keypress",function(a){13===a.which&&(b.ajaxSearch(),a.preventDefault())}),c.bind("blur",function(a){b.ajaxSearch()})}}}]),angular.module(angAppName).directive("viewmodeCustom",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",link:function(a,b,c){var d=new lscfAccordionPosts;a.directiveInfo.ready=function(){setTimeout(function(){d.init()},500),"undefined"!=typeof lscfOnCustomTemplateReady&&lscfOnCustomTemplateReady(),setTimeout(function(){lscfEventListenerOnCustomTemplateReady()},300)},a.directiveInfo.afterPostsLoadCallback=function(){setTimeout(function(){d.init()},500),"undefined"!=typeof lscfPostsLoadCallback&&lscfPostsLoadCallback(),setTimeout(function(){lscfEventListenerPostsLoadCallback()},400)},a.changeGridType=function(b,c){for(var d=document.getElementsByClassName("lscf-woo-grid-type"),e=0;e<d.length;e++)d[e].className="lscf-woo-grid-type";b.currentTarget.className="lscf-woo-grid-type active",a.gridColumns=c}},template:'<div ng-include="pluginSettings.filterSettings.theme.custom_template.url">'}}]),angular.module(angAppName).directive("viewmodeDefault",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-default.html",link:function(a,b,c){a.actionSettings.initPostTheme=!0;var d=new lscfPosts;a.directiveInfo.ready=function(){d.init(),d.constructHover(),a.standartize_shortcodes_container_height(),"undefined"!=typeof capfData.settings&&"undefined"!=typeof capfData.settings.theme&&("undefined"!=typeof capfData.settings.theme.viewchanger&&"undefined"!=typeof capfData.settings.theme.viewchanger.list&&1!=capfData.settings.theme.viewchanger.grid&&1==capfData.settings.theme.viewchanger.list||(jQuery(".lscf-posts-block").addClass("block-view"),jQuery(".viewMode > div").removeClass("active"),jQuery(".viewMode #blockView").addClass("active")))},a.directiveInfo.afterPostsLoadCallback=function(){d.constructHover(),a.standartize_shortcodes_container_height()}}}}]),angular.module(angAppName).directive("liveSearch",["customFilterService",function(a){return{restrict:"AE",require:"?ngModel",scope:!0,bindToController:!0,controllerAs:"vm",link:function(b,c,d,e){var f=null,g=!0,h=[];b.postsHasLoaded=!1,lscf_initLiveSearch(function(){$j(".lscf-live-search-input").focus(function(){!0===b.actionSettings.lsLoadPosts&&(b.postsHasLoaded=!1,"undefined"!=typeof capfData.settings.theme.posts_display_from&&"undefined"!==capfData.settings.theme.posts_display_from.post_taxonomies.active_terms&&capfData.settings.theme.posts_display_from.post_taxonomies.active_terms.length>0&&(f={default_filter:{}},f.default_filter.post_taxonomies=capfData.settings.theme.posts_display_from.post_taxonomies,h=f),b.actionSettings.activeQuery.length>0&&(h=b.actionSettings.activeQuery),a.getAllPosts(b.postType,200,1,h).success(function(a){b.postsHasLoaded=!0,b.actionSettings.lsLoadPosts=!1,!0===g&&(lscfPostsList=new lscfPosts),g=!1,posts=a.posts}))})}),b.$watch("pxsearch",function(a,c){"undefined"!=typeof a&&a!=c&&(b.loadMoreBtn.postsLoading=!0),b.$watch("postsHasLoaded",function(d,e){if(!0===d&&"undefined"!=typeof a&&a!=c){b.$parent.loadMoreBtn.morePostsAvailable=!1;var f=[];""!==a&&"undefined"!=typeof posts?posts.forEach(function(b){var c=pxDecodeEntities(b.title.long.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,"")),d=pxDecodeEntities(b.title.short.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,"")),e=pxDecodeEntities(b.content.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,""));a.toLowerCase()==d.toLowerCase()?b.class_name="ls-matches-search":b.class_name="",c.toLowerCase().indexOf(a.toLowerCase())==-1&&b.full_content.toLowerCase().indexOf(a.toLowerCase())==-1||(c=c.replace(new RegExp("("+a+")","ig"),'<strong class="matched-word">$1</strong>'),d=d.replace(new RegExp("("+a+")","ig"),'<strong class="matched-word">$1</strong>'),e=e.replace(new RegExp(a,"ig"),'<strong class="matched-word">$1</strong>'),b.title.long=c,b.title.short=d,b.content=e,f.push(b))}):"undefined"!=typeof posts&&(b.loadMoreBtn.postsLoading=!0,posts.forEach(function(a){var b=a.title.long.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,""),c=a.title.short.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,""),d=a.content.replace(/(<strong(.*?)class\=\"matched-word\"\>)|(<\/strong\>)/gi,"");a.title.long=b,a.title.short=c,a.content=d,f.push(a)})),b.$parent.filterPostsTemplate.posts=f,lscfPostsList.constructHover(),b.loadMoreBtn.postsLoading=!1}})}),b.$watch("pxsearch_woo_sku",function(a,c){"undefined"!=typeof a&&a!=c&&(b.loadMoreBtn.postsLoading=!0),b.$watch("postsHasLoaded",function(d,e){if(!0===d&&"undefined"!=typeof a&&a!=c){b.$parent.loadMoreBtn.morePostsAvailable=!1;var f=[];""!==a?posts.forEach(function(b){"undefined"!=typeof b.woocommerce.sku&&b.woocommerce.sku.toLowerCase().indexOf(a.toLowerCase())!=-1&&f.push(b)}):"undefined"!==posts&&posts.forEach(function(a){f.push(a)}),b.$parent.filterPostsTemplate.posts=f,lscfPostsList.constructHover()}})})}}}]),angular.module(angAppName).directive("viewmodePortrait",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-portrait.html",link:function(a,b,c){a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){},a.directiveInfo.afterPostsLoadCallback=function(){}}}}]),angular.module(angAppName).directive("sidebarLiveCustomizer",["customFilterService",function(a){return{restrict:"AE",require:"?ngModel",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/sidebar-live-customizer.html",link:function(a,b,c,d){a.$watch("pluginSettings.custom_templates",function(b,c){if("undefined"!=typeof a.pluginSettings.filterSettings.theme.custom_template&&"undefined"!=typeof a.pluginSettings.custom_templates&&"custom-theme"==a.pluginSettings.filterSettings.theme.display)for(var d=0;d<a.pluginSettings.custom_templates.length;d++)a.pluginSettings.filterSettings.theme.custom_template.slug==a.pluginSettings.custom_templates[d].slug?a.pluginSettings.custom_templates[d].checked=!0:a.pluginSettings.custom_templates[d].checked=!1});var e,f,g=new lscfSidebarCustomizator;setTimeout(function(){g.init(),g.initColorpicker(function(b){g.generateDynamicCssColor(b),a.$apply(function(){a.pluginSettings.filterSettings["main-color"]=b.hex,a.pluginSettings.filterSettings["main-color-rgb"]=b.rgb,e=angular.toJson(a.pluginSettings),g.saveSettings(e)})}),g.saveExtraOptions(function(b){a.$apply(function(){switch(b.type){case"taxonomies-listing":a.pluginSettings.filterSettings.theme.posts_display_from=b.data;break;case"settings-page":a.pluginSettings.generalSettings.run_shortcodes=g.templateData.settings.run_shortcodes.value,a.pluginSettings.generalSettings.disable_empty_option_on_filtering=g.templateData.settings.disable_empty_option_on_filtering.value,a.pluginSettings.generalSettings.infinite_scrolling=g.templateData.settings.infinite_scrolling.value,a.pluginSettings.generalSettings.checkboxes_conditional_logic=g.templateData.settings.checkboxes_conditional_logic.value,a.pluginSettings.generalSettings.order_by=g.templateData.settings.order_by,a.pluginSettings.generalSettings.default_order_by=g.templateData.settings.default_order_by}e=angular.toJson(a.pluginSettings),g.saveSettings(e)})}),g.onFormAction(function(b){switch(b.dataType){case"order-fields":a.$apply(function(){a.actionSettings.initFieldsDraggable=b.fieldValue});break;case"sidebar-position":a.$apply(function(){a.pluginSettings.filterSettings.theme.sidebar.position=b.fieldValue,a.actionSettings.initSidebar=!0,f=a.makeWrapperClassName(),a.pluginSettings.className.sidebar=f.sidebar,a.pluginSettings.className.posts_theme=f.posts_theme});break;case"theme-style":a.$apply(function(){if(a.pluginSettings.filterSettings.theme.display=b.fieldValue,"custom-theme"==b.fieldValue){var c=parseInt(b.custom_theme_active_index);"undefined"==typeof a.pluginSettings.filterSettings.theme.custom_template&&(a.pluginSettings.filterSettings.theme.custom_template={}),a.pluginSettings.filterSettings.theme.custom_template.url=a.pluginSettings.custom_templates[c].url,a.pluginSettings.filterSettings.theme.custom_template.name=a.pluginSettings.custom_templates[c].name,a.pluginSettings.filterSettings.theme.custom_template.slug=a.pluginSettings.custom_templates[c].slug}});break;case"columns-number":var c=parseInt(b.fieldValue);a.$apply(function(){a.pluginSettings.filterSettings.theme.columns=c,a.pluginSettings.className.sidebar=c>3?"col-sm-2 col-md-2 col-lg-2":"col-sm-3 col-md-3 col-lg-3",a.pluginSettings.className.posts_theme=c>3?"col-sm-10 col-md-10 col-lg-10":"col-sm-9 col-md-9 col-lg-9"});break;case"view-changer":switch(b.fieldValue){case"full":a.$apply(function(){a.pluginSettings.filterSettings.theme.viewchanger.grid=1,a.pluginSettings.filterSettings.theme.viewchanger.list=1}),jQuery(".viewMode").fadeIn(),jQuery(".lscf-posts-block").addClass("block-view"),jQuery(".viewMode > div").removeClass("active"),jQuery(".viewMode #blockView").addClass("active");break;case"list":a.$apply(function(){a.pluginSettings.filterSettings.theme.viewchanger.grid=0,a.pluginSettings.filterSettings.theme.viewchanger.list=1}),jQuery(".viewMode").hide(),jQuery(".lscf-posts-block").removeClass("block-view");break;case"grid":a.$apply(function(){a.pluginSettings.filterSettings.theme.viewchanger.grid=1,a.pluginSettings.filterSettings.theme.viewchanger.list=0}),jQuery(".viewMode").hide(),jQuery(".lscf-posts-block").addClass("block-view")}break;case"link-type":a.$apply(function(){a.pluginSettings.filterSettings.theme.link_type=b.fieldValue,a.actionSettings.initPostTheme=!0});break;case"posts-per-page":a.$apply(function(){a.actionSettings.postsPerPage=b.fieldValue,a.pluginSettings.filterSettings["posts-per-page"]=b.fieldValue})}e=angular.toJson(a.pluginSettings),g.saveSettings(e)})},800)}}}]),angular.module(angAppName).directive("sortBy",["customFilterService",function(a){return{restrict:"AE",require:"?ngModel",scope:!0,bindToController:!0,controllerAs:"vm",link:function(b,c,d,e){var f,g,h,i=!1,j=jQuery;b.$watch("pluginSettings.generalSettings.order_by.items",function(d,e){"undefined"!=typeof b.pluginSettings.generalSettings.order_by&&"undefined"!=typeof b.pluginSettings.generalSettings.order_by.items&&b.pluginSettings.generalSettings.order_by.items.length>0&&(h='<select data-class="lscf-order-by-dropdown lscf-sorting-by" class="lscf-sorting-custom-dropdown">',h+='<option value="0">'+b.pluginSettings.generalSettings.writing.sort_by+"</option>",b.pluginSettings.generalSettings.order_by.items.forEach(function(a){h+='<option value="'+a.id+'">'+a.name+"</option>"}),h+="</select>",h+='<div class="lscf-sorting-opt">',h+='<div class="lscf-sort-up"><span class="glyphicon glyphicon-triangle-top"></span></div>',h+='<div class="lscf-sort-down"><span class="glyphicon glyphicon-triangle-bottom"></span></div>',h+="</div>",c[0].innerHTML=h,lscfSortingCustomDropddown(),"undefined"!=typeof capfData.settings.theme.posts_display_from&&"undefined"!==capfData.settings.theme.posts_display_from.post_taxonomies.active_terms&&capfData.settings.theme.posts_display_from.post_taxonomies.active_terms.length>0&&b.actionSettings.customFields.push({ID:"default_filter",type:"default_filter",default_filter:{post_taxonomies:capfData.settings.theme.posts_display_from.post_taxonomies}}),j(".px-capf-wrapper").addClass("lscf-active-sort-by"),j(".lscf-sort-up").click(function(){j(this).addClass("active"),j(".lscf-sort-down").removeClass("active");for(var c="DESC",d=0;d<b.actionSettings.customFields.length;d++)if(f=b.actionSettings.customFields[d],"order-by"==f.ID){b.actionSettings.customFields[d].order=c,i=!0;break}!1===i&&(query={ID:"order-by",filter_as:null,type:"order-posts",order:c,value:"post_date"},b.actionSettings.customFields.push(query)),b.loadMoreBtn.postsLoading=!0,a.getPosts(b.postType,b.actionSettings.postsPerPage,1,b.actionSettings.customFields).success(function(a){b.actionSettings.postsCount=a.postsCount,b.actionSettings.pagesCount=a.pages,b.actionSettings.pxCurrentPage=2,b.actionSettings.pxCurrentPage<=a.pages?b.loadMoreBtn.morePostsAvailable=!0:b.loadMoreBtn.morePostsAvailable=!1,b.actionSettings.filterPostsTemplate=a.posts,b.filterPostsTemplate.posts=a.posts,b.loadMoreBtn.postsLoading=!1,b.directiveInfo.afterPostsLoadCallback()})}),j(".lscf-sort-down").click(function(){j(this).addClass("active"),j(".lscf-sort-up").removeClass("active");for(var c="ASC",d=0;d<b.actionSettings.customFields.length;d++)if(f=b.actionSettings.customFields[d],"order-by"==f.ID){b.actionSettings.customFields[d].order=c,i=!0;break}!1===i&&(query={ID:"order-by",filter_as:null,type:"order-posts",order:c,value:"post_date"},b.actionSettings.customFields.push(query)),b.loadMoreBtn.postsLoading=!0,a.getPosts(b.postType,b.actionSettings.postsPerPage,1,b.actionSettings.customFields).success(function(a){b.actionSettings.postsCount=a.postsCount,b.actionSettings.pagesCount=a.pages,b.actionSettings.pxCurrentPage=2,b.actionSettings.pxCurrentPage<=a.pages?b.loadMoreBtn.morePostsAvailable=!0:b.loadMoreBtn.morePostsAvailable=!1,b.actionSettings.filterPostsTemplate=a.posts,b.filterPostsTemplate.posts=a.posts,b.loadMoreBtn.postsLoading=!1,b.directiveInfo.afterPostsLoadCallback()})}),j(".lscf-sorting-by .lscf-dropdown-option").each(function(){j(this).click(function(){g=j(this).attr("rel"),"0"==g?(j(".lscf-sorting-by").removeClass("active"),j(".lscf-sort-down").removeClass("active"),j(".lscf-sort-up").removeClass("active")):j(".lscf-sorting-by").addClass("active");for(var c=0;c<b.actionSettings.customFields.length;c++)if(f=b.actionSettings.customFields[c],"order-by"==f.ID){b.actionSettings.customFields[c].value=g,i=!0;break}!1===i&&(query={ID:"order-by",filter_as:null,type:"order-posts",order:"ASC",value:g},b.actionSettings.customFields.push(query)),b.loadMoreBtn.postsLoading=!0,a.getPosts(b.postType,b.actionSettings.postsPerPage,1,b.actionSettings.customFields).success(function(a){b.actionSettings.postsCount=a.postsCount,b.actionSettings.pagesCount=a.pages,b.actionSettings.pxCurrentPage=2,b.actionSettings.pxCurrentPage<=a.pages?b.loadMoreBtn.morePostsAvailable=!0:b.loadMoreBtn.morePostsAvailable=!1,b.actionSettings.filterPostsTemplate=a.posts,b.filterPostsTemplate.posts=a.posts,b.loadMoreBtn.postsLoading=!1,b.directiveInfo.afterPostsLoadCallback()})})}))})}}}]),angular.module(angAppName).directive("viewmodeBasicGrid",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-basic-grid.html",link:function(a,b,c){a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){},a.directiveInfo.afterPostsLoadCallback=function(){}}}}]),angular.module(angAppName).directive("viewmodeMasonryGrid",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-mansonry.html",link:function(a,b,c){a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){},a.directiveInfo.afterPostsLoadCallback=function(){}}}}]),angular.module(angAppName).directive("viewmodeWoocommerceGrid",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-woocommerce-grid-2.html",link:function(a,b,c){a.gridColumns=3,a.changeGridType=function(b,c){for(var d=document.getElementsByClassName("lscf-woo-grid-type"),e=0;e<d.length;e++)d[e].className="lscf-woo-grid-type";b.currentTarget.className="lscf-woo-grid-type active",a.gridColumns=c},a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){},a.directiveInfo.afterPostsLoadCallback=function(){}}}}]),angular.module(angAppName).directive("viewmodeWoocommerce",["customFilterService",function(a){return{restrict:"AE",scope:!0,bindToController:!0,controllerAs:"vm",templateUrl:capfData.plugin_url+"app/views/posts-woocommerce.html",link:function(a,b,c){a.actionSettings.initPostTheme=!0,a.directiveInfo.ready=function(){},a.directiveInfo.afterPostsLoadCallback=function(){}}}}]);